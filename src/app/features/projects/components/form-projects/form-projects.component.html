<p-toast />
<form [formGroup]="projectForm">
  <p-stepper [value]="currentStep()">
    <!-- PASSO 1: Identificação Básica -->
    <p-step-item [value]="1">
      <p-step>Identificação</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="grid gap-4">
            <app-input-form
              id="titulo"
              label="Título do Projeto *"
              type="text"
              [control]="getControl('titulo')"
              initialIcon="heroDocumentText"
              placeholder="Nome completo do projeto" />

            <app-input-form
              id="titulacao"
              label="Titulação *"
              type="text"
              [control]="getControl('titulacao')"
              initialIcon="heroAcademicCap"
              placeholder="Ex: Graduação, Mestrado, etc" />

            <app-input-form
              id="vagas_totais"
              label="Vagas Disponíveis *"
              type="number"
              [control]="getControl('vagas_totais')"
              initialIcon="heroUserGroup"
              placeholder="Número total de vagas" />
          </div>

          <div class="flex justify-end py-6">
            <p-button
              label="Próximo"
              (onClick)="activateCallback(2)"
              [disabled]="
                !projectForm.get('titulo')?.valid ||
                !projectForm.get('titulacao')?.valid ||
                !projectForm.get('vagas_totais')?.valid
              " />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- PASSO 2: Detalhes Acadêmicos -->
    <p-step-item [value]="2">
      <p-step>Detalhes Acadêmicos</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="grid gap-4">
            <app-input-form
              id="linha_de_pesquisa"
              label="Linha de Pesquisa *"
              type="text"
              [control]="getControl('linha_de_pesquisa')"
              initialIcon="heroMagnifyingGlass"
              placeholder="Área principal de pesquisa" />

            <app-text-area
              id="sumario"
              label="Sumário *"
              [control]="getControl('sumario')"
              placeholder="Resumo conciso do projeto (máx. 500 caracteres)"
              [rows]="3" />
          </div>

          <div class="flex justify-between py-6">
            <p-button
              label="Voltar"
              severity="secondary"
              (onClick)="activateCallback(1)" />
            <p-button
              label="Próximo"
              (onClick)="activateCallback(3)"
              [disabled]="
                !projectForm.get('linha_de_pesquisa')?.valid ||
                !projectForm.get('sumario')?.valid
              " />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- PASSO 3: Metodologia -->
    <p-step-item [value]="3">
      <p-step>Metodologia</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="grid gap-4">
            <app-text-area
              id="objetivo_geral"
              label="Objetivo Geral *"
              [control]="getControl('objetivo_geral')"
              placeholder="Objetivo principal do projeto"
              [rows]="4" />

            <app-text-area
              id="objetivo_especifico"
              label="Objetivos Específicos *"
              [control]="getControl('objetivo_especifico')"
              placeholder="Liste os objetivos específicos"
              [rows]="4" />

            <app-text-area
              id="metodologia"
              label="Metodologia *"
              [control]="getControl('metodologia')"
              placeholder="Descreva os métodos de pesquisa"
              [rows]="4" />
          </div>

          <div class="flex justify-between py-6">
            <p-button
              label="Voltar"
              severity="secondary"
              (onClick)="activateCallback(2)" />
            <p-button
              label="Próximo"
              (onClick)="activateCallback(4)"
              [disabled]="
                !projectForm.get('objetivo_geral')?.valid ||
                !projectForm.get('objetivo_especifico')?.valid ||
                !projectForm.get('metodologia')?.valid
              " />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- PASSO 4: Logística -->
    <p-step-item [value]="4">
      <p-step>Logística</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="grid gap-4">
            <app-input-form
              id="localizacao"
              label="Localização *"
              type="text"
              [control]="getControl('localizacao')"
              initialIcon="heroMapPin"
              placeholder="Local físico do projeto" />

            <app-input-form
              id="populacao"
              label="Público-Alvo *"
              type="text"
              [control]="getControl('populacao')"
              initialIcon="heroUserGroup"
              placeholder="População envolvida" />

            <app-text-area
              id="cronograma_atividades"
              label="Cronograma *"
              [control]="getControl('cronograma_atividades')"
              placeholder="Etapas e prazos do projeto"
              [rows]="4" />

            <app-text-area
              id="justificativa"
              label="Justificativa *"
              [control]="getControl('justificativa')"
              placeholder="Relevância do projeto"
              [rows]="4" />
          </div>

          <div class="flex justify-between py-6">
            <p-button
              label="Voltar"
              severity="secondary"
              (onClick)="activateCallback(3)" />
            <p-button
              label="Próximo"
              (onClick)="activateCallback(5)"
              [disabled]="
                !projectForm.get('localizacao')?.valid ||
                !projectForm.get('populacao')?.valid ||
                !projectForm.get('cronograma_atividades')?.valid ||
                !projectForm.get('justificativa')?.valid
              " />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>

    <!-- PASSO 5: Finalização -->
    <p-step-item [value]="5">
      <p-step>Finalização</p-step>
      <p-step-panel>
        <ng-template #content let-activateCallback="activateCallback">
          <div class="grid gap-2">
            <label
              for="palavras_chave"
              class="block font-inter text-sm font-normal text-dark"
              >Palavras-chave *</label
            >
            <p-chips
              id="palavras_chave"
              formControlName="palavras_chave"
              placeholder="Digite e pressione Enter"
              separator=","
              class="w-full">
              <ng-template pTemplate="chip" let-item>
                <span>{{ item }}</span>
              </ng-template>
            </p-chips>

            <app-text-area
              id="referencias"
              label="Referências *"
              [control]="getControl('referencias')"
              placeholder="Bibliografia utilizada"
              [rows]="4" />

            <div class="flex items-center">
              <p-checkbox
                [binary]="true"
                formControlName="aceitou_termos"
                inputId="aceitou_termos"></p-checkbox>
              <label for="aceitou_termos" class="ml-2">
                Declaro que as informações são verídicas *
              </label>
            </div>
          </div>

          <div class="flex justify-between py-6">
            <p-button
              label="Voltar"
              severity="secondary"
              (onClick)="activateCallback(4)" />
            <p-button
              label="Enviar Projeto"
              (onClick)="submitForm()"
              [disabled]="!projectForm.valid" />
          </div>
        </ng-template>
      </p-step-panel>
    </p-step-item>
  </p-stepper>
</form>
